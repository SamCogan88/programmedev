<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QQI Programme Schedule Template</title>
    <style>
      :root {
        --display-font-size: 9pt;
        --copy-font-size: 11pt;
      }
      html {
        scroll-behavior: smooth;
      }
      body {
        font-family: Calibri, sans-serif;
        font-size: var(--display-font-size);
        margin: 15pt;
        background-color: #f5f5f5;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        background-color: white;
        margin-bottom: 15pt;
        font-family: Calibri, sans-serif;
        font-size: var(--display-font-size);
      }
      th,
      td {
        border: 1pt solid #000;
        padding: 4.5pt;
        text-align: left;
      }
      th {
        background-color: #d9e1f2;
        font-weight: bold;
      }
      .form-section-title {
        background-color: #d9e1f2;
        font-weight: bold;
      }
      .label-cell {
        background-color: #e7e6e6;
        font-weight: bold;
      }
      .checkbox-label {
        background-color: #f2f2f2;
        font-weight: bold;
      }
      .instruction-text {
        font-size: 7.5pt;
        color: #333;
      }
      .empty-data {
        background-color: #ffffff;
        min-height: 15pt;
      }
      h1 {
        color: #333;
        font-size: 14pt;
        margin-bottom: 15pt;
      }
      #upload-section {
        background-color: white;
        padding: 11pt;
        margin-bottom: 15pt;
        border: 2pt dashed #ccc;
        border-radius: 3pt;
        transition:
          border-color 0.2s,
          background-color 0.2s;
      }
      #upload-section.drag-over {
        border-color: #4a90d9;
        background-color: #f0f7ff;
      }
      #upload-section label {
        font-weight: bold;
        margin-right: 7.5pt;
      }
      .drop-hint {
        color: #666;
        font-size: 9pt;
        margin-left: 7.5pt;
      }
      #upload-status {
        margin-left: 11pt;
        font-style: italic;
      }
      .success {
        color: green;
      }
      .error {
        color: red;
      }
      .checked::after {
        content: " ✔";
      }
      #schedules-container {
        max-width: 260mm; /* A4 landscape width */
      }
      #module-descriptors-container {
        max-width: 180mm; /* A4 portrait width */
      }
      .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 2pt solid #2e75b6;
        margin-top: 20pt;
        margin-bottom: 10pt;
        padding-bottom: 4pt;
      }
      .section-header h2 {
        color: #2e75b6;
        font-size: 14pt;
        font-weight: bold;
        margin: 0;
      }
      .section-header .copy-btn,
      .section-header .back-to-top-btn {
        padding: 4.5pt 9pt;
        cursor: pointer;
        font-size: 10pt;
      }
      .section-header .btn-group {
        display: flex;
        gap: 6pt;
      }
      .page-break {
        page-break-after: always;
        margin-top: 30pt;
      }
      .section-title {
        color: #2e75b6;
        font-size: 14pt;
        font-weight: bold;
        margin-top: 20pt;
        margin-bottom: 10pt;
        border-bottom: 2pt solid #2e75b6;
        padding-bottom: 4pt;
      }
      /* Module Descriptor Tables */
      .module-table,
      .staff-table,
      .assessment-table,
      .mimlo-table,
      .summative-table,
      .content-table {
        width: 650px;
        max-width: 100%;
        border-collapse: collapse;
        font-family: Calibri, sans-serif;
        font-size: var(--display-font-size);
        color: #111;
        margin-bottom: 15pt;
        background-color: white;
      }
      .module-table th,
      .module-table td,
      .staff-table th,
      .staff-table td,
      .assessment-table th,
      .assessment-table td,
      .mimlo-table th,
      .mimlo-table td,
      .summative-table th,
      .summative-table td,
      .content-table th,
      .content-table td {
        border: 1px solid #333;
        padding: 6px 8px;
        vertical-align: middle;
      }
      .mimlo-table th,
      .mimlo-table td,
      .summative-table th,
      .summative-table td,
      .content-table td {
        vertical-align: top;
      }
      .title-row th {
        background: #e6e6e6;
        font-weight: 700;
        font-size: 14px;
        text-align: left;
      }
      .note {
        font-weight: 400;
        font-style: italic;
        font-size: 11px;
      }
      .hdr {
        background: #d9e2f3;
        font-weight: 700;
      }
      .subhdr {
        background: #ffffff;
        font-weight: 700;
      }
      .grey {
        background: #e6e6e6;
        font-weight: 700;
      }
      .blue {
        background: #d9e2f3;
        font-weight: 700;
      }
      .center {
        text-align: center;
      }
      .tight {
        padding-top: 4px;
        padding-bottom: 4px;
      }
      .content-area {
        min-height: 60px;
      }
      /* MIPLO Assessment Strategy Table (Section 6.8) */
      .miplo-assessment-table {
        width: 650px;
        max-width: 100%;
        border-collapse: collapse;
        font-family: Calibri, sans-serif;
        font-size: var(--display-font-size);
        color: #111;
        margin-bottom: 15pt;
        background-color: white;
      }
      .miplo-assessment-table th,
      .miplo-assessment-table td {
        border: 1px solid #333;
        padding: 6px 8px;
        vertical-align: top;
      }
      /* Table of Contents */
      .toc-container {
        background-color: white;
        border: 1pt solid #ddd;
        border-radius: 3pt;
        margin-bottom: 15pt;
        padding: 0;
      }
      .toc-container h2 {
        color: #2e75b6;
        font-size: 12pt;
        font-weight: bold;
        margin: 0;
        padding: 9pt 11pt;
        border-bottom: 1pt solid #ddd;
      }
      .toc-list {
        list-style: none;
        margin: 0;
        padding: 0;
      }
      .toc-list li {
        border-bottom: 1pt solid #eee;
      }
      .toc-list li:last-child {
        border-bottom: none;
      }
      .toc-list a {
        display: block;
        padding: 7pt 11pt;
        color: #2e75b6;
        text-decoration: none;
        font-size: 10pt;
        transition: background-color 0.15s;
      }
      .toc-list a:hover {
        background-color: #f0f7ff;
        text-decoration: underline;
      }
      .placeholder-text {
        color: #666;
        font-style: italic;
        padding: 15pt;
        background-color: #f9f9f9;
        border: 1pt dashed #ccc;
        text-align: center;
      }
      .vertical-header {
        vertical-align: middle;
        text-align: center;
        padding: 0;
        height: 75pt;
      }
      .vertical-header span {
        writing-mode: vertical-rl;
        transform: rotate(180deg);
        display: inline-block;
        height: 70pt;
        overflow: hidden;
        padding: 2pt;
        font-size: 7pt;
        line-height: 1.2;
        text-align: left;
      }
    </style>
  </head>
  <body>
    <h1>QQI Programme Schedule Template</h1>

    <div id="upload-section">
      <label for="file-upload">Upload Programme JSON:</label>
      <input type="file" id="file-upload" accept=".json" />
      <span class="drop-hint">(or drag and drop a file here)</span>
      <button
        type="button"
        id="load-from-app-btn"
        style="margin-left: 11pt; padding: 4.5pt 9pt; cursor: pointer"
      >
        Load from App
      </button>
      <button
        type="button"
        id="download-docx-btn"
        style="margin-left: 4pt; padding: 4.5pt 9pt; cursor: pointer"
      >
        Download DOCX
      </button>
      <span id="upload-status"></span>
    </div>

    <!-- Table of Contents -->
    <nav class="toc-container" id="toc" style="display: none">
      <h2>Table of Contents</h2>
      <ul class="toc-list">
        <li><a href="#schedules-section">Section 2: Proposed Programme Schedule(s)</a></li>
        <li>
          <a href="#miplo-assessment-section">Section 6.8: Assessment Strategy aligned to MIPLOs</a>
        </li>
        <li><a href="#module-descriptors-section">Section 7: Module Descriptors</a></li>
      </ul>
    </nav>

    <!-- Section 2: Programme Schedules -->
    <div id="schedules-section"></div>
    <div class="section-header" id="schedules-header" style="display: none">
      <h2>Section 2: Proposed Programme Schedule(s)</h2>
      <div class="btn-group">
        <button type="button" class="copy-btn" id="copy-schedules-btn">Copy All</button>
        <a href="#toc" class="back-to-top-btn">Back to Top</a>
      </div>
    </div>
    <div id="schedules-container">
      <p class="placeholder-text">Upload a programme JSON file to generate programme schedules.</p>
    </div>

    <!-- Section 6.8: MIPLO Assessment Strategy -->
    <div id="miplo-assessment-section"></div>
    <div class="section-header" id="miplo-assessment-header" style="display: none">
      <h2>Section 6.8: Assessment Strategy aligned to MIPLOs</h2>
      <div class="btn-group">
        <button type="button" class="copy-btn" id="copy-miplo-assessment-btn">Copy All</button>
        <a href="#toc" class="back-to-top-btn">Back to Top</a>
      </div>
    </div>
    <div id="miplo-assessment-container">
      <p class="placeholder-text">
        Upload a programme JSON file to generate the MIPLO assessment strategy table.
      </p>
    </div>

    <!-- Section 7: Module Descriptors -->
    <div id="module-descriptors-section"></div>
    <div class="section-header" id="module-descriptors-header" style="display: none">
      <h2>Section 7: Module Descriptors</h2>
      <div class="btn-group">
        <button type="button" class="copy-btn" id="copy-module-descriptors-btn">Copy All</button>
        <a href="#toc" class="back-to-top-btn">Back to Top</a>
      </div>
    </div>
    <div id="module-descriptors-container">
      <p class="placeholder-text">Upload a programme JSON file to generate module descriptors.</p>
    </div>

    <!-- NOTES -->
    <div
      style="
        font-size: 8pt;
        color: #666;
        margin-top: 15pt;
        padding: 7.5pt;
        background-color: #f9f9f9;
        border: 1pt solid #ddd;
      "
    >
      <strong>INSTRUCTIONS FOR USE:</strong>
      <ul>
        <li>Upload a programme JSON file to automatically populate the schedule tables</li>
        <li>
          A separate schedule table will be generated for each stage in each programme version
        </li>
        <li>Copy rows and paste below to add additional module data rows</li>
        <li>
          Copy the entire table to create schedules for different stages or programme versions
        </li>
        <li>
          Mark checkboxes (✔) in delivery modes, teaching modalities, and assessment techniques rows
        </li>
      </ul>
    </div>

    <script type="module" src="/src/template.ts"></script>
  </body>
</html>
